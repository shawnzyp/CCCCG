<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<meta name="description" content="Mobile-optimized character tracker for the Catalyst Core RPG."/>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
<link rel="icon" type="image/png" sizes="1024x1024" href="images/logo.png"/>
<link rel="apple-touch-icon" sizes="180x180" href="images/logo.png"/>
<link rel="shortcut icon" type="image/png" sizes="1024x1024" href="images/logo.png"/>
<meta property="og:image" content="images/logo.png"/>
<meta name="twitter:image" content="images/logo.png"/>
<meta name="theme-color" content="#0e1117"/>
<meta name="color-scheme" content="dark light"/>
<title>Catalyst Core</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="styles/main.css"/>
</head>
<body class="launching">
<noscript>This app requires JavaScript to run properly.</noscript>

<div id="launch-animation" role="presentation" aria-hidden="true">
  <video
    autoplay
    muted
    playsinline
    preload="auto"
    webkit-playsinline
    data-src-webm="media/launch-animation.webm"
    data-src-mp4="media/launch-animation.mp4"
  >
    <source src="images/b02fb7b3-095b-4e40-9e4e-20fb5ee3b4b9.mp4" type="video/mp4"/>
    Sorry, your browser does not support the launch animation video.
  </video>
</div>
<script>
  (function(){
    const DEFAULT_FALLBACK = 12000;
    const MIN_VISIBLE = 1800;
    const body = document.body;
    const launchEl = document.getElementById('launch-animation');
    const video = launchEl ? launchEl.querySelector('video') : null;
    if(!body || !launchEl){
      return;
    }

    let fallbackTimer = null;
    const clearFallback = () => {
      if(fallbackTimer){
        window.clearTimeout(fallbackTimer);
        fallbackTimer = null;
      }
    };

    const hideLaunch = () => {
      if(!body.classList.contains('launching')){
        return;
      }
      clearFallback();
      body.classList.remove('launching');
      launchEl.setAttribute('data-hidden', 'true');
      launchEl.addEventListener('transitionend', () => {
        if(launchEl.parentNode){
          launchEl.parentNode.removeChild(launchEl);
        }
      }, { once: true });
      window.setTimeout(() => {
        if(launchEl.parentNode){
          launchEl.parentNode.removeChild(launchEl);
        }
      }, 800);
    };

    const scheduleFallback = (delay = DEFAULT_FALLBACK) => {
      clearFallback();
      const timeout = Math.max(delay, MIN_VISIBLE);
      fallbackTimer = window.setTimeout(() => {
        if(body.classList.contains('launching')){
          hideLaunch();
        }
      }, timeout);
    };

    if(video){
      const ensureAttributes = () => {
        try { video.setAttribute('playsinline', ''); } catch (err) {}
        try { video.setAttribute('webkit-playsinline', ''); } catch (err) {}
        try {
          if(!video.hasAttribute('muted')){
            video.setAttribute('muted', '');
          }
          video.muted = true;
        } catch (err) {}
      };
      const attemptPlay = () => {
        ensureAttributes();
        if(typeof video.play === 'function'){
          const playAttempt = video.play();
          if(playAttempt && typeof playAttempt.catch === 'function'){
            playAttempt.catch(() => {});
          }
        }
      };
      const handleReady = () => {
        attemptPlay();
        const durationMs = Number.isFinite(video.duration) && video.duration > 0
          ? (video.duration * 1000) + 500
          : DEFAULT_FALLBACK;
        scheduleFallback(durationMs);
      };
      ensureAttributes();
      video.addEventListener('ended', hideLaunch, { once: true });
      ['error','abort','stalled','suspend'].forEach(evt => {
        video.addEventListener(evt, () => scheduleFallback(MIN_VISIBLE), { once: true });
      });
      video.addEventListener('loadeddata', ensureAttributes, { once: true });
      if(video.readyState >= 1){
        handleReady();
      } else {
        video.addEventListener('loadedmetadata', handleReady, { once: true });
        scheduleFallback(DEFAULT_FALLBACK);
      }
    }

    if(!video){
      if(document.readyState === 'complete'){
        scheduleFallback();
      } else {
        window.addEventListener('load', () => scheduleFallback(), { once: true });
      }
    }
  })();
</script>

<div class="app-shell" data-launch-shell>
<a href="#main" class="skip-link">Skip to main content</a>


<header>
  <div class="top">
    <button class="logo-button" type="button" aria-label="Cycle theme" title="Cycle theme" data-theme-toggle>
      <span class="theme-toggle__icon" aria-hidden="true">
        <span class="theme-toggle__spinner">
          <span class="theme-toggle__face theme-toggle__face--front"></span>
          <span class="theme-toggle__face theme-toggle__face--back"></span>
        </span>
      </span>
      <span class="theme-toggle__label sr-only">Theme</span>
    </button>
    <span class="tabs-title"><span class="tabs-title__label">Catalyst Core</span></span>
    <div class="dropdown">
      <button id="btn-menu" class="icon" aria-label="Menu" title="Menu" aria-haspopup="true" aria-expanded="false" aria-controls="menu-actions" type="button">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 6.75h15m-15 5.25h15m-15 5.25h15"/>
        </svg>
      </button>
      <span
        id="cloud-sync-status"
        class="sync-status-indicator"
        data-status="online"
        role="status"
        aria-live="polite"
        aria-label="Cloud sync status: Online"
        title="Online"
      >
        <span class="sync-status-indicator__light" aria-hidden="true"></span>
        <span class="sr-only" data-sync-status-label>Online</span>
      </span>
      <div id="menu-actions" class="menu" hidden>
        <button id="btn-load" class="btn-sm">Load / Save</button>
        <button id="btn-enc" class="btn-sm" aria-label="Encounter / Initiative" title="Encounter / Initiative">Encounter / Initiative</button>
        <button id="btn-log" class="btn-sm">Action Log</button>
        <button id="btn-campaign" class="btn-sm">Campaign Log</button>
        <button id="btn-rules" class="btn-sm">Rules</button>
        <button id="btn-help" class="btn-sm">Help</button>
      </div>
    </div>
  </div>
  <nav class="tabs" role="tablist" aria-label="Primary">
    <button class="tab active" data-go="combat" aria-label="Combat" title="Combat" role="tab" aria-current="page" type="button">
      <span class="tab__icon" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <polyline stroke-linecap="round" stroke-linejoin="round" points="14.5 17.5 3 6 3 3 6 3 17.5 14.5"/>
          <line stroke-linecap="round" stroke-linejoin="round" x1="13" y1="19" x2="19" y2="13"/>
          <line stroke-linecap="round" stroke-linejoin="round" x1="16" y1="16" x2="20" y2="20"/>
          <line stroke-linecap="round" stroke-linejoin="round" x1="19" y1="21" x2="21" y2="19"/>
        </svg>
      </span>
      <span class="tab__label">Combat</span>
    </button>
    <button class="tab" data-go="abilities" aria-label="Abilities" title="Abilities" role="tab" type="button">
      <span class="tab__icon" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.8132 15.9038L9 18.75L8.1868 15.9038C7.75968 14.4089 6.59112 13.2403 5.09619 12.8132L2.25 12L5.09619 11.1868C6.59113 10.7597 7.75968 9.59112 8.1868 8.09619L9 5.25L9.8132 8.09619C10.2403 9.59113 11.4089 10.7597 12.9038 11.1868L15.75 12L12.9038 12.8132C11.4089 13.2403 10.2403 14.4089 9.8132 15.9038Z"/>
          <path stroke-linecap="round" stroke-linejoin="round" d="M18.2589 8.71454L18 9.75L17.7411 8.71454C17.4388 7.50533 16.4947 6.56117 15.2855 6.25887L14.25 6L15.2855 5.74113C16.4947 5.43883 17.4388 4.49467 17.7411 3.28546L18 2.25L18.2589 3.28546C18.5612 4.49467 19.5053 5.43883 20.7145 5.74113L21.75 6L20.7145 6.25887C19.5053 6.56117 18.5612 7.50533 18.2589 8.71454Z"/>
          <path stroke-linecap="round" stroke-linejoin="round" d="M16.8942 20.5673L16.5 21.75L16.1058 20.5673C15.8818 19.8954 15.3546 19.3682 14.6827 19.1442L13.5 18.75L14.6827 18.3558C15.3546 18.1318 15.8818 17.6046 16.1058 16.9327L16.5 15.75L16.8942 16.9327C17.1182 17.6046 17.6454 18.1318 18.3173 18.3558L19.5 18.75L18.3173 19.1442C17.6454 19.3682 17.1182 19.8954 16.8942 20.5673Z"/>
        </svg>
      </span>
      <span class="tab__label">Abilities</span>
    </button>
    <button class="tab" data-go="powers" aria-label="Powers" title="Powers" role="tab" type="button">
      <span class="tab__icon" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5L14.25 2.25L12 10.5H20.25L9.75 21.75L12 13.5H3.75Z"/>
        </svg>
      </span>
      <span class="tab__label">Powers</span>
    </button>
    <button class="tab" data-go="gear" aria-label="Gear" title="Gear" role="tab" type="button">
      <span class="tab__icon" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z"/>
        </svg>
      </span>
      <span class="tab__label">Gear</span>
    </button>
    <button class="tab" data-go="story" aria-label="Story" title="Story" role="tab" type="button">
      <span class="tab__icon" aria-hidden="true">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.04168C10.4077 4.61656 8.30506 3.75 6 3.75C4.94809 3.75 3.93834 3.93046 3 4.26212V18.5121C3.93834 18.1805 4.94809 18 6 18C8.30506 18 10.4077 18.8666 12 20.2917M12 6.04168C13.5923 4.61656 15.6949 3.75 18 3.75C19.0519 3.75 20.0617 3.93046 21 4.26212V18.5121C20.0617 18.1805 19.0519 18 18 18C15.6949 18 13.5923 18.8666 12 20.2917M12 6.04168V20.2917"/>
        </svg>
      </span>
      <span class="tab__label">Story</span>
    </button>
  </nav>
  <div class="news-ticker" role="status" aria-live="polite" aria-labelledby="news-ticker-label" data-expand-edge>
    <div class="news-ticker__inner">
      <span class="news-ticker__label" id="news-ticker-label">
        <span class="news-ticker__logo" aria-hidden="true" role="presentation"></span>
        <span class="sr-only">O.M.N.I tip ticker</span>
      </span>
      <div class="news-ticker__track" data-fun-ticker-track>
        <span class="news-ticker__text" data-fun-ticker-text>Loading fun tips…</span>
      </div>
    </div>
  </div>
  <div class="news-ticker news-ticker--m24n" role="status" aria-live="polite" aria-labelledby="m24n-ticker-label" data-expand-edge>
    <div class="news-ticker__inner">
      <span class="news-ticker__label news-ticker__label--m24n" id="m24n-ticker-label">
        <span class="news-ticker__logo news-ticker__logo--m24n" aria-hidden="true">MN24/7:</span>
        <span class="news-ticker__badge news-ticker__badge--live" aria-hidden="true">LIVE</span>
        <span class="sr-only">MN24/7 breaking news ticker</span>
      </span>
      <div class="news-ticker__track news-ticker__track--m24n" data-m24n-ticker-track>
        <span class="news-ticker__text news-ticker__text--m24n" data-m24n-ticker-text>Loading MN24/7 feed…</span>
      </div>
    </div>
  </div>
</header>

<main id="main">
  <!-- COMBAT -->
  <fieldset data-tab="combat" class="card">
    <section id="somf-min" class="somf-card" hidden>
      <h3 class="somf-title">The Shards of Many Fates</h3>
      <div class="somf-row">
        <label for="somf-min-count" class="somf-label">Shards</label>
        <input id="somf-min-count" type="number" inputmode="numeric" pattern="[0-9]*" min="1" max="22" value="1" class="somf-input" data-view-allow>
        <button id="somf-min-draw" type="button" class="somf-btn somf-primary">Draw Shards</button>
      </div>
    </section>

    <h2 class="card-title">Combat</h2>

    <fieldset class="card roll-tools-card">
      <legend data-animate-title>Dice, Coin &amp; Initiative</legend>
      <div class="roll-tools">
        <div class="roll-tools__panel">
          <h3 class="roll-tools__heading">Dice Roll</h3>
          <div class="dice-roll-grid">
            <div class="dice-roll-grid__results">
              <span class="pill result" id="dice-out" data-placeholder="000"></span>
              <ul id="dice-breakdown" class="dice-breakdown" aria-live="polite" hidden></ul>
            </div>
            <div class="dice-roll-grid__field">
              <label for="dice-sides" class="sr-only">Sides</label>
              <select id="dice-sides" data-view-allow>
                <option value="4">d4</option><option value="6">d6</option><option value="8">d8</option><option value="10">d10</option><option value="12">d12</option><option value="20" selected>d20</option><option value="100">d100</option>
              </select>
            </div>
            <div class="dice-roll-grid__field">
              <label for="dice-count" class="sr-only">Count</label>
              <input id="dice-count" data-view-allow type="number" inputmode="numeric" pattern="[0-9]*" min="1" value="1"/>
            </div>
            <button id="roll-dice" class="btn-sm">Roll</button>
          </div>
        </div>
        <div class="roll-tools__panel">
          <h3 class="roll-tools__heading">Coin Flip</h3>
          <span class="pill result" id="flip-out" data-placeholder="Heads"></span>
          <div class="inline">
            <button id="flip" class="btn-sm">Flip</button>
          </div>
        </div>
      </div>
      <div class="roll-tools__initiative">
        <div class="initiative-field">
          <label for="initiative">Initiative</label>
          <span id="initiative-roll-result" class="pill result" data-placeholder="Roll"></span>
          <input id="initiative" type="text" inputmode="numeric" pattern="[0-9]*" placeholder="auto from DEX + bonuses" readonly/>
          <button type="button" id="roll-initiative" class="btn-sm" aria-label="Roll Initiative">Roll</button>
        </div>
      </div>
    </fieldset>
    <fieldset id="death-saves" class="card" hidden disabled>
      <legend data-animate-title>Death Saves</legend>
      <div class="death-saves-grid">
        <div class="death-save-tracks">
          <div class="death-save-group">
            <span>Successes</span>
            <label for="death-success-1" class="sr-only">Success 1</label>
            <input type="checkbox" id="death-success-1"/>
            <label for="death-success-2" class="sr-only">Success 2</label>
            <input type="checkbox" id="death-success-2"/>
            <label for="death-success-3" class="sr-only">Success 3</label>
            <input type="checkbox" id="death-success-3"/>
          </div>
          <div class="death-save-group">
            <span>Failures</span>
            <label for="death-fail-1" class="sr-only">Failure 1</label>
            <input type="checkbox" id="death-fail-1"/>
            <label for="death-fail-2" class="sr-only">Failure 2</label>
            <input type="checkbox" id="death-fail-2"/>
            <label for="death-fail-3" class="sr-only">Failure 3</label>
            <input type="checkbox" id="death-fail-3"/>
          </div>
        </div>
        <span id="death-save-out" class="death-save-result" data-placeholder="Roll"></span>
        <div class="death-save-buttons">
          <button id="roll-death-save" class="btn-sm" type="button">Roll</button>
          <button id="death-save-reset" class="btn-sm" type="button">Reset</button>
        </div>
      </div>
    </fieldset>
    <div class="grid grid-1">
      <fieldset class="card hp-field">
        <legend class="card-legend card-legend--actions" data-animate-title>
          <span class="card-legend__content">
            <span class="card-legend__title">HP</span>
            <button
              type="button"
              class="card-caret"
              id="hp-settings-toggle"
              aria-haspopup="dialog"
              aria-expanded="false"
              aria-controls="modal-hp-settings"
              aria-label="Edit HP options"
              title="Edit HP options"
            >
              <span class="btn-icon" aria-hidden="true">✎</span>
            </button>
          </span>
        </legend>
        <input id="hp-roll" type="hidden" value="0"/>
        <div class="inline">
          <div class="bar-label">
            <progress id="hp-bar" max="30" value="30"></progress>
            <span id="hp-pill">30/30</span>
          </div>
        </div>
        <div class="inline">
          <label for="hp-amt" class="sr-only">Amount</label>
          <input id="hp-amt" data-view-allow type="number" inputmode="numeric" pattern="[0-9]*" placeholder="Amount"/>
        </div>
        <div class="inline">
          <button id="hp-dmg" class="btn-sm">Damage</button>
          <button id="hp-heal" class="btn-sm">Heal</button>
        </div>
      </fieldset>
      <fieldset class="card sp-field">
        <legend class="card-legend card-legend--actions" data-animate-title>
          <span class="card-legend__content">
            <span class="card-legend__title">SP</span>
            <button
              type="button"
              class="card-caret"
              id="sp-settings-toggle"
              aria-haspopup="dialog"
              aria-expanded="false"
              aria-controls="modal-sp-settings"
              aria-label="Edit SP options"
              title="Edit SP options"
            >
              <span class="btn-icon" aria-hidden="true">✎</span>
            </button>
          </span>
        </legend>
        <div class="inline">
          <div class="bar-label">
            <progress id="sp-bar" max="5" value="5"></progress>
            <span id="sp-pill">5/5</span>
          </div>
        </div>
        <div class="sp-grid">
          <button class="btn-sm" data-sp="-1">-1 SP</button>
          <button class="btn-sm" data-sp="-2">-2 SP</button>
          <button class="btn-sm" data-sp="-3">-3 SP</button>
          <button class="btn-sm" data-sp="-4">-4 SP</button>
          <button class="btn-sm" data-sp="-5">-5 SP</button>
          <button id="sp-full" class="btn-sm">Reset SP</button>
        </div>
      </fieldset>
      <fieldset class="card cap-field">
        <legend data-animate-title>Cinematic Action Point</legend>
        <p class="card-info">Each session grants one Cinematic Action Point. A wildcard for heroic stunts, clutch rerolls, or narrative swings. Check it when you spend the boost; it stays used until a Long Rest or session reset.</p>
        <div class="cap-box">
          <label for="cap-check">
            <input type="checkbox" id="cap-check"/>
            <span class="cap-label-text" data-animate-title>Cinematic Action Point</span>
            <span id="cap-status">Available</span>
          </label>
        </div>
      </fieldset>
    </div>

    <div class="grid grid-1">
      <fieldset class="card">
        <legend data-animate-title>Stats and Effects</legend>
        <div class="stat-trio">
          <div class="stat-trio__item">
            <label for="speed">Speed (ft)</label>
            <input id="speed" type="number" inputmode="numeric" pattern="[0-9]*" placeholder="30"/>
          </div>
          <div class="stat-trio__item">
            <label for="pp">Passive Perception</label>
            <input id="pp" type="number" inputmode="numeric" pattern="[0-9]*" readonly/>
          </div>
          <div class="stat-trio__item">
            <label for="tc">TC</label>
            <input id="tc" type="number" inputmode="numeric" pattern="[0-9]*" readonly/>
          </div>
        </div>
        <div class="status-effects">
          <h3>Status Effects</h3>
          <div id="statuses" class="grid grid-1"></div>
          <div id="ongoing-effects" class="grid grid-1" aria-live="polite" style="margin-top:12px;gap:8px"></div>
        </div>
      </fieldset>

      <fieldset id="resonance-points" class="card">
        <legend data-animate-title>Resonance Points (RP)</legend>
        <p>
          Resonance Points are awarded by the GM for truly heroic acts. At <strong>5 RP</strong>, trigger a Heroic Surge for temporary boosts.
        </p>

        <div class="rp-row">
          <label class="rp-label" for="rp-value">Current RP</label>
          <output id="rp-value" aria-live="polite">0</output>
        </div>

        <div class="rp-track" role="group" aria-label="Resonance Points Track">
          <button type="button" id="rp-dec" aria-label="Spend Resonance Point">-</button>
          <button type="button" class="rp-dot" data-rp="1" aria-pressed="false" disabled></button>
          <button type="button" class="rp-dot" data-rp="2" aria-pressed="false" disabled></button>
          <button type="button" class="rp-dot" data-rp="3" aria-pressed="false" disabled></button>
          <button type="button" class="rp-dot" data-rp="4" aria-pressed="false" disabled></button>
          <button type="button" class="rp-dot" data-rp="5" aria-pressed="false" disabled></button>
          <button type="button" id="rp-inc" aria-label="Gain Resonance Point">+</button>
          <div class="rp-bank" aria-live="polite">
            <span class="rp-bank-label">Bank</span>
            <span class="rp-dot rp-bank-dot" data-bank="1" aria-pressed="false"></span>
            <span class="rp-dot rp-bank-dot" data-bank="2" aria-pressed="false"></span>
          </div>
        </div>

        <hr class="rp-divide">

        <div class="rp-surge">
          <div class="rp-surge-status" aria-live="polite">
            <input type="checkbox" id="rp-trigger" disabled aria-label="Activate Heroic Surge"/>
            <strong>Surge Active:</strong> <span id="rp-surge-state">Inactive</span>
          </div>

          <div id="rp-surge-details">
            <h3>Heroic Surge Effects</h3>
            <ul class="rp-list">
              <li>Roleplay checks: +2 to CHA/WIS/INT (leadership, persuasion, interpretation)</li>
              <li>Combat: +1d4 to all attack rolls and saving throws</li>
              <li>SP Flow: +1 SP regenerated per round</li>
              <li>Bonus XP: grant at session end (GM)</li>
            </ul>
            <p class="subtext">Duration: 1 encounter or 10 minutes of narrative time</p>
            <p class="subtext">Aftermath: first save at disadvantage; first round next combat regenerate 1 fewer SP</p>
          </div>

          <div class="rp-surge-controls">
            <button type="button" id="rp-clear-aftermath" disabled aria-label="Aftermath">Aftermath</button>
          </div>

          <div class="rp-tags">
            <span id="rp-tag-active" hidden class="tag">Surge Active</span>
            <span id="rp-tag-aftermath" hidden class="tag warn">Aftermath Pending</span>
          </div>
        </div>
      </fieldset>
    </div>
  </fieldset>

  <!-- ABILITIES -->
  <fieldset data-tab="abilities" class="card" id="card-abilities">
    <div class="card-toolbar">
      <h2 class="card-title card-toolbar__title card-toolbar__title--inline" id="card-abilities-title">
        <span class="card-toolbar__title-text">Ability Scores</span>
        <button
          type="button"
          class="card-caret card-edit-toggle"
          data-view-target="#card-abilities"
          data-view-label="Ability Scores"
          aria-describedby="card-abilities-title"
        >
          <span class="btn-icon" aria-hidden="true">✎</span>
          <span class="btn-label card-edit-toggle__label sr-only">Edit</span>
        </button>
      </h2>
    </div>
    <div id="abil-grid" class="grid ability-grid" data-view-lock></div>
    <fieldset class="card">
      <legend data-animate-title>Proficiency and Power</legend>
      <div class="proficiency-card__grid">
        <div class="proficiency-card__field">
          <label for="prof-bonus">Proficiency Bonus</label>
          <input id="prof-bonus" type="number" inputmode="numeric" pattern="[0-9]*" value="2" readonly/>
        </div>
        <div class="proficiency-card__field">
          <label for="power-save-ability">Power Save Ability</label>
          <select id="power-save-ability">
            <option value="str">STR</option><option value="dex">DEX</option><option value="con">CON</option>
            <option value="int">INT</option><option value="wis" selected>WIS</option><option value="cha">CHA</option>
          </select>
        </div>
      </div>
      <div class="proficiency-card__hidden" aria-hidden="true">
        <input id="power-dc-formula" type="hidden" value="Proficiency"/>
        <div hidden>
          <label data-animate-title class="sr-only" for="power-save-dc">Power Save DC</label>
          <input id="power-save-dc" type="number" inputmode="numeric" pattern="[0-9]*" readonly/>
        </div>
        <div hidden>
          <label class="sr-only" for="power-range-unit">Default Range Unit</label>
          <select id="power-range-unit">
            <option value="feet" selected>Feet</option>
            <option value="narrative">Narrative</option>
          </select>
        </div>
        <div hidden>
          <label class="sr-only" for="power-suggestion-strength">Auto-Suggestion Strength</label>
          <select id="power-suggestion-strength">
            <option value="off">Off</option>
            <option value="conservative" selected>Conservative</option>
            <option value="assertive">Assertive</option>
          </select>
        </div>
        <div hidden>
          <label class="sr-only" for="power-range-metric">Show metric ranges</label>
          <input type="checkbox" id="power-range-metric"/>
        </div>
        <div hidden>
          <label class="sr-only" for="power-text-compact">Use compact rules text</label>
          <input type="checkbox" id="power-text-compact"/>
        </div>
        <div hidden>
          <label class="sr-only" for="power-dc-mode-simple">Save DC Formula</label>
          <input type="radio" name="power-dc-mode" id="power-dc-mode-simple" value="Simple"/>
          <input type="radio" name="power-dc-mode" id="power-dc-mode-proficiency" value="Proficiency" checked/>
        </div>
      </div>
    </fieldset>
    <fieldset class="card">
      <legend data-animate-title>Saving Throws</legend>
      <div id="saves" class="grid ability-grid"></div>
    </fieldset>
    <fieldset class="card">
      <legend data-animate-title>Skills</legend>
      <div id="skills" class="grid ability-grid"></div>
    </fieldset>
  </fieldset>

  <!-- POWERS -->
  <fieldset data-tab="powers" class="card">
    <h2 class="card-title">Powers</h2>
    <div class="card-toolbar">
      <div class="card-toolbar__actions">
        <button id="add-power" style="max-width:180px">
          <span class="btn-icon" aria-hidden="true">➕</span>
          <span class="btn-label">Add Power</span>
        </button>
      </div>
    </div>
    <div class="grid grid-2" id="powers"></div>

    <h3 style="margin:16px 0 8px">Signature Moves</h3>
    <div class="card-toolbar">
      <div class="card-toolbar__actions">
        <button id="add-sig" style="max-width:200px">
          <span class="btn-icon" aria-hidden="true">➕</span>
          <span class="btn-label">Add Signature Move</span>
        </button>
      </div>
    </div>
    <div class="grid grid-2" id="sigs"></div>
  </fieldset>

  <!-- GEAR -->
  <fieldset data-tab="gear" class="card">
    <h2 class="card-title">Gear</h2>
    <div class="grid grid-2">
      <div class="card gear-card">
        <div class="card-toolbar">
          <h3 class="gear-card-title card-toolbar__title">Weapons</h3>
          <div class="card-toolbar__actions">
            <button id="add-weapon" class="btn-sm gear-card-action" style="max-width:140px">
              <span class="btn-icon" aria-hidden="true">➕</span>
              <span class="btn-label">Add Weapon</span>
            </button>
          </div>
        </div>
        <div id="weapons" class="grid grid-1"></div>
      </div>
      <div class="card gear-card">
        <div class="card-toolbar">
          <h3 class="gear-card-title card-toolbar__title">Armor and Protection</h3>
          <div class="card-toolbar__actions">
            <button id="add-armor" class="btn-sm gear-card-action" style="max-width:160px">
              <span class="btn-icon" aria-hidden="true">➕</span>
              <span class="btn-label">Add Armor</span>
            </button>
          </div>
        </div>
        <div id="armors" class="grid grid-1"></div>
      </div>
      <div class="card" style="grid-column:1/-1">
        <div class="card-toolbar">
          <h3 class="card-toolbar__title">Gear and Items</h3>
          <div class="card-toolbar__actions">
            <button id="add-item" class="btn-sm" style="max-width:140px">
              <span class="btn-icon" aria-hidden="true">➕</span>
              <span class="btn-label">Add Item</span>
            </button>
            <button id="open-catalog" class="btn-sm" style="max-width:160px">
              <span class="btn-icon" aria-hidden="true">📚</span>
              <span class="btn-label">Open Gear Catalog</span>
            </button>
          </div>
        </div>
        <div id="items" class="grid grid-1"></div>
      </div>
    </div>
  </fieldset>

  <!-- STORY -->
  <fieldset data-tab="story" class="card" id="card-story">
    <div class="card-toolbar">
      <h2 class="card-title card-toolbar__title card-toolbar__title--inline" id="card-story-title">
        <span class="card-toolbar__title-text">Character and Story</span>
        <button
          type="button"
          class="card-caret card-edit-toggle"
          data-view-target="#card-story"
          data-view-label="Character and Story"
          aria-describedby="card-story-title"
        >
          <span class="btn-icon" aria-hidden="true">✎</span>
          <span class="btn-label card-edit-toggle__label sr-only">Edit</span>
        </button>
      </h2>
    </div>
    <div class="grid grid-2">
      <div class="card" data-view-lock><label for="superhero">Superhero Identity</label><input id="superhero" placeholder="Vigilante Name"/></div>
      <div class="card" data-view-lock><label for="secret">Secret Identity</label><input id="secret" placeholder="Real name"/></div>
      <div class="card" data-view-lock>
        <label for="publicIdentity">Public Identity</label>
        <select id="publicIdentity"><option value="Public">Public</option><option value="Secret" selected>Secret</option></select>
      </div>
      <div class="card" data-view-lock>
        <label for="tier">Tier</label>
        <input id="tier" type="text" readonly/>
      </div>
      <div class="card" style="grid-column:1/-1">
        <label data-animate-title>Experience</label>
        <input id="xp" type="hidden" value="0"/>
        <div class="inline">
          <div class="bar-label">
            <progress id="xp-bar" max="2000" value="0"></progress>
            <span id="xp-pill">0/2000</span>
          </div>
        </div>
        <div class="inline">
          <label for="xp-amt" class="sr-only">Amount</label>
          <input id="xp-amt" data-view-allow type="number" inputmode="numeric" pattern="[0-9]*" placeholder="Amount"/>
          <select id="xp-mode" data-view-allow style="max-width:160px">
            <option value="add">Add XP</option>
            <option value="remove">Remove XP</option>
          </select>
          <button id="xp-submit" class="btn-sm">Submit</button>
        </div>
      </div>
      <div class="card" data-view-lock>
        <label for="alignment">Alignment</label>
        <select id="alignment">
          <option value="">Select one</option>
          <option>Paragon (Lawful Light)</option>
          <option>Guardian (Neutral Light)</option>
          <option>Vigilante (Chaotic Light)</option>
          <option>Sentinel (Lawful Neutral)</option>
          <option>Outsider (True Neutral)</option>
          <option>Wildcard (Chaotic Neutral)</option>
          <option>Inquisitor (Lawful Shadow)</option>
          <option>Anti-Hero (Neutral Shadow)</option>
          <option>Renegade (Chaotic Shadow)</option>
        </select>
        <ul id="alignment-perks" class="perk-list"></ul>
      </div>
      <div class="card" data-view-lock>
        <label for="classification">Classification</label>
        <select id="classification">
          <option value="">Select one</option><option>Mutant</option><option>Enhanced Human</option><option>Magic User</option><option>Alien/Extraterrestrial</option><option>Mystical Being</option>
        </select>
        <ul id="classification-perks" class="perk-list"></ul>
      </div>
      <div class="card" data-view-lock>
        <label for="power-style">Primary Power Style</label>
        <select id="power-style">
          <option value="">Select one</option><option>Physical Powerhouse</option><option>Energy Manipulator</option><option>Speedster</option>
          <option>Telekinetic/Psychic</option><option>Illusionist</option><option>Shape-shifter</option><option>Elemental Controller</option>
        </select>
        <ul id="power-style-perks" class="perk-list"></ul>
      </div>
      <div class="card" data-view-lock>
        <label for="power-style-2">Secondary Power Style</label>
        <select id="power-style-2">
          <option value="">Select one</option>
          <option>None</option>
          <option>Physical Powerhouse</option><option>Energy Manipulator</option><option>Speedster</option>
          <option>Telekinetic/Psychic</option><option>Illusionist</option><option>Shape-shifter</option><option>Elemental Controller</option>
        </select>
      </div>
      <div class="card" data-view-lock>
        <label for="origin">Origin Story</label>
        <select id="origin">
          <option value="">Select one</option>
          <option>The Accident</option>
          <option>The Experiment</option>
          <option>The Legacy</option>
          <option>The Awakening</option>
          <option>The Pact</option>
          <option>The Lost Time</option>
          <option>The Exposure</option>
          <option>The Rebirth</option>
          <option>The Vigil</option>
          <option>The Redemption</option>
        </select>
        <ul id="origin-perks" class="perk-list"></ul>
      </div>
      <div class="card">
        <label for="credits" data-animate-title>Credits</label>
        <div class="inline">
          <span class="credits-currency" aria-hidden="true">₡</span>
          <span id="credits-total-pill" class="pill">0</span>
        </div>
        <div class="credits-summary">
          <span id="credits-gear-total" class="pill pill-sm">Equipped Gear: ₡0</span>
          <span id="credits-gear-remaining" class="pill pill-sm">Remaining Credits: ₡0</span>
        </div>
        <div class="inline">
          <label for="credits-amt" class="sr-only">Amount</label>
          <input id="credits-amt" data-view-allow type="number" inputmode="numeric" pattern="[0-9]*" placeholder="Amount"/>
          <select id="credits-mode" data-view-allow>
            <option value="add">Add Credits</option>
            <option value="subtract">Spend Credits</option>
          </select>
          <button id="credits-submit" class="btn-sm" type="button">Apply</button>
        </div>
        <input id="credits" type="hidden" value="0"/>
      </div>
      <div class="card card-wide">
        <label data-animate-title>Faction Reputation</label>
        <div class="faction-rep">
          <div class="faction-rep__card">
            <div class="faction-rep__header">
              <span class="pill pill-sm">O.M.N.I.</span>
              <span id="omni-rep-tier" class="pill pill-sm">Neutral</span>
            </div>
            <progress id="omni-rep-bar" max="100" value="0"></progress>
            <div class="inline">
              <button id="omni-rep-gain" class="btn-sm">Gain</button>
              <button id="omni-rep-lose" class="btn-sm">Lose</button>
            </div>
            <input type="hidden" id="omni-rep" value="200"/>
            <div class="faction-rep__perk">
              <span class="faction-rep__perk-label">Current Perk</span>
              <p id="omni-rep-perk" class="perk"></p>
            </div>
          </div>
          <div class="faction-rep__card">
            <div class="faction-rep__header">
              <span class="pill pill-sm">P.F.V.</span>
              <span id="pfv-rep-tier" class="pill pill-sm">Neutral</span>
            </div>
            <progress id="pfv-rep-bar" max="100" value="0"></progress>
            <div class="inline">
              <button id="pfv-rep-gain" class="btn-sm">Gain</button>
              <button id="pfv-rep-lose" class="btn-sm">Lose</button>
            </div>
            <input type="hidden" id="pfv-rep" value="200"/>
            <div class="faction-rep__perk">
              <span class="faction-rep__perk-label">Current Perk</span>
              <p id="pfv-rep-perk" class="perk"></p>
            </div>
          </div>
          <div class="faction-rep__card">
            <div class="faction-rep__header">
              <span class="pill pill-sm">Cosmic Conclave</span>
              <span id="conclave-rep-tier" class="pill pill-sm">Neutral</span>
            </div>
            <progress id="conclave-rep-bar" max="100" value="0"></progress>
            <div class="inline">
              <button id="conclave-rep-gain" class="btn-sm">Gain</button>
              <button id="conclave-rep-lose" class="btn-sm">Lose</button>
            </div>
            <input type="hidden" id="conclave-rep" value="200"/>
            <div class="faction-rep__perk">
              <span class="faction-rep__perk-label">Current Perk</span>
              <p id="conclave-rep-perk" class="perk"></p>
            </div>
          </div>
          <div class="faction-rep__card">
            <div class="faction-rep__header">
              <span class="pill pill-sm">Greyline PMC</span>
              <span id="greyline-rep-tier" class="pill pill-sm">Neutral</span>
            </div>
            <progress id="greyline-rep-bar" max="100" value="0"></progress>
            <div class="inline">
              <button id="greyline-rep-gain" class="btn-sm">Gain</button>
              <button id="greyline-rep-lose" class="btn-sm">Lose</button>
            </div>
            <input type="hidden" id="greyline-rep" value="200"/>
            <div class="faction-rep__perk">
              <span class="faction-rep__perk-label">Current Perk</span>
              <p id="greyline-rep-perk" class="perk"></p>
            </div>
          </div>
          <div class="faction-rep__card">
            <div class="faction-rep__header">
              <span class="pill pill-sm">The Government</span>
              <span id="government-rep-tier" class="pill pill-sm">Neutral</span>
            </div>
            <progress id="government-rep-bar" max="100" value="0"></progress>
            <div class="inline">
              <button id="government-rep-gain" class="btn-sm">Gain</button>
              <button id="government-rep-lose" class="btn-sm">Lose</button>
            </div>
            <input type="hidden" id="government-rep" value="200"/>
            <div class="faction-rep__perk">
              <span class="faction-rep__perk-label">Current Perk</span>
              <p id="government-rep-perk" class="perk"></p>
            </div>
          </div>
          <div class="faction-rep__card">
            <div class="faction-rep__header">
              <span class="pill pill-sm">Public Opinion</span>
              <span id="public-rep-tier" class="pill pill-sm">Neutral</span>
            </div>
            <progress id="public-rep-bar" max="100" value="0"></progress>
            <div class="inline">
              <button id="public-rep-gain" class="btn-sm">Gain</button>
              <button id="public-rep-lose" class="btn-sm">Lose</button>
            </div>
            <input type="hidden" id="public-rep" value="200"/>
            <div class="faction-rep__perk">
              <span class="faction-rep__perk-label">Current Perk</span>
              <p id="public-rep-perk" class="perk"></p>
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="card" data-view-lock>
      <label for="story-notes" data-animate-title>Backstory / Notes</label>
      <textarea id="story-notes" rows="6" placeholder="Key events, allies, vulnerabilities, research/training notes, etc."></textarea>
    </div>
      <h3>Character Questions</h3>
    <div class="grid grid-1">
      <div class="card" data-view-lock><label for="q-mask">Who are you behind the mask?</label><textarea id="q-mask" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-justice">What does justice mean to you?</label><textarea id="q-justice" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-fear">What is your biggest fear or unresolved trauma?</label><textarea id="q-fear" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-first-power">What moment first defined your sense of power—was it thrilling, terrifying, or tragic?</label><textarea id="q-first-power" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-origin-meaning">What does your Origin Story mean to you now?</label><textarea id="q-origin-meaning" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-before-powers">What was your life like before you had powers or before you remembered having them?</label><textarea id="q-before-powers" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-power-scare">What is one way your powers scare even you?</label><textarea id="q-power-scare" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-signature-move">What is your signature move or ability, and how does it reflect who you are?</label><textarea id="q-signature-move" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-emotional">What happens to your powers when you are emotionally compromised?</label><textarea id="q-emotional" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-no-line">What line will you never cross even if the world burns around you?</label><textarea id="q-no-line" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-alignment-fear">Which Alignment do you identify with, and which do you fear becoming?</label><textarea id="q-alignment-fear" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-opinion">Whose opinion matters more to you—civilians, teammates, or your faction superiors? Why?</label><textarea id="q-opinion" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-drive">What drives you to fight—justice, guilt, revenge, legacy, redemption, or something else?</label><textarea id="q-drive" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-walk-away">What would make you walk away from this life for good?</label><textarea id="q-walk-away" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-secret">What is one major secret you are keeping from the rest of the team?</label><textarea id="q-secret" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-vulnerable">What situation leaves you the most vulnerable—physically, emotionally, or strategically?</label><textarea id="q-vulnerable" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-admire">Which teammate do you admire the most and what do they have that you lack?</label><textarea id="q-admire" rows="2"></textarea></div>
      <div class="card" data-view-lock><label for="q-if-lost">If you lost your powers tomorrow, who would you still be?</label><textarea id="q-if-lost" rows="2"></textarea></div>
    </div>
  </fieldset>

</main>


<div class="overlay hidden" id="modal-load-list" aria-hidden="true">
  <div class="modal modal--load-save" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>All Characters</h3>
    <div id="char-list" class="catalog"></div>
    <div class="actions actions--center modal--load-save__actions">
      <button id="btn-save" class="btn-sm" type="button">Save</button>
      <button id="recover-save" class="btn-sm" type="button">Recover Save</button>
      <button id="create-character" class="btn-sm" type="button">Create New</button>
    </div>
  </div>
</div>

<div class="overlay hidden" id="modal-recover-char" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Select Character</h3>
    <div id="recover-char-list" class="catalog"></div>
  </div>
</div>

<div class="overlay hidden" id="modal-recover-list" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Recover Backup</h3>
    <div id="recover-list" class="catalog"></div>
  </div>
</div>

<div class="overlay hidden" id="modal-load" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <p id="load-confirm-text"></p>
    <div class="actions">
      <button id="load-cancel" class="btn-sm">Cancel</button>
      <button id="load-accept" class="btn-sm">Accept</button>
    </div>
  </div>
</div>

<div class="overlay hidden" id="modal-pin" aria-hidden="true">
  <section class="modal">
    <button id="pin-close" class="x" aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3 id="pin-title">Enter PIN</h3>
    <input id="pin-input" data-view-allow type="password" inputmode="numeric" pattern="[0-9]*" autocomplete="one-time-code">
    <div class="actions"><button id="pin-submit" class="somf-btn">OK</button></div>
  </section>
</div>

<!-- WELCOME MODAL -->
<div class="overlay hidden" id="modal-welcome" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3 class="welcome-modal__title">Welcome to the <span class="welcome-modal__title-break">Catalyst Core!</span></h3>
    <p><u>Create or Load Your Hero Profile</u><br>
    This is your Vigilante record. Without it, you don’t exist in the Core.</p>
    <p aria-hidden="true">&nbsp;</p>
    <p><u>Use the Tabs</u><br>
    <span class="welcome-modal__tab-label">Combat:</span> Track your combat stats.<br>
    <span class="welcome-modal__tab-label">Stats:</span> Track your abilities, and skills.<br>
    <span class="welcome-modal__tab-label">Powers:</span> Track your powers and signature moves.<br>
    <span class="welcome-modal__tab-label">Gear:</span> Requisition, equip, upgrade and update your arsenal.<br>
    <span class="welcome-modal__tab-label">Personal Details:</span> Log your mission details and personal intel.</p>
    <p aria-hidden="true">&nbsp;</p>
    <p><u>Save &amp; Sync</u><br>
    Auto-Save every 2 minutes to O.M.N.I.’s network. No excuses for lost data.</p>
    <p aria-hidden="true">&nbsp;</p>
    <p>This isn’t a toy. It’s your mission log, your survival plan, and the record of the legacy you’ll leave behind. Use it well.</p>
    <p aria-hidden="true">&nbsp;</p>
    <p><strong>O.M.N.I. Command</strong></p>
    <div class="actions">
      <button id="welcome-create-character" type="button">Create New Character</button>
      <button id="welcome-load-character" type="button">Load Character</button>
      <button id="welcome-skip" type="button">Skip</button>
    </div>
  </div>
</div>

<!-- HELP MODAL -->
<div class="overlay hidden" id="modal-help" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Catalyst Core Help</h3>
    <p>
      Keep this reference open while you play to understand what each tab, modal, and control in the current build is designed to
      do.
    </p>
    <h4>Getting Started</h4>
    <ul class="feature-list">
      <li>
        <b>Launch &amp; Welcome</b>
        The intro video plays the first time you open the sheet during a visit. Tap <i>Skip</i> on the welcome modal or wait for the
        clip to finish and the sheet unlocks automatically for the rest of the session.
      </li>
      <li>
        <b>Create or Load</b>
        Start from the welcome modal or open <i>Load / Save</i> from the menu to create a new hero, switch between existing records,
        or recover a backup.
      </li>
      <li>
        <b>Offline Ready</b>
        Once your character data loads, the tracker continues working without a connection. Changes sync the next time you come
        back online.
      </li>
    </ul>
    <h4>Navigating the Sheet</h4>
    <ul class="feature-list">
      <li>
        <b>Tabs</b>
        Use the tab bar to swap between Combat, Abilities, Powers, Gear, and Story. Combat handles HP, SP, status tracking, dice
        tools, and Resonance Points. Abilities keeps ability scores, saves, and skills linked to your proficiency bonus. Powers
        stores reusable cards and Signature Moves. Gear tracks loadouts, credits, and catalog imports. Story captures identity
        details, classifications, reputation, and notes.
      </li>
      <li>
        <b>Main Menu</b>
        The header menu button opens overlays for Load / Save, Encounter / Initiative, Action Log, Campaign Log, Rules,
        and this Help screen. Each modal floats above the sheet so you never lose context, and you can close any of them with Esc
        or by tapping outside.
      </li>
      <li>
        <b>Themes &amp; Visibility</b>
        Click the Catalyst Core logo to cycle through every available theme. Your selection is stored locally, and certain
        Story-tab classifications apply their matching palette automatically.
      </li>
    </ul>
    <h4>Managing Characters</h4>
    <ul class="feature-list">
      <li>
        <b>Autosave &amp; Manual Saves</b>
        Character changes write to local storage automatically while you edit. Use the <i>Save</i> button in Load / Save to create a
        manual snapshot before big scenes.
      </li>
      <li>
        <b>Recover Backups</b>
        <i>Recover Save</i> lists recent autosaves and manual backups with timestamps. Restoring one replaces the sheet only after
        you confirm, giving you a safe way to undo mistakes.
      </li>
      <li>
        <b>PIN Protection</b>
        Assign a numeric PIN to any character from the Load / Save manager. The sheet will request that code before loading or
        editing that record on shared devices.
      </li>
    </ul>
    <h4>Session Tools</h4>
    <ul class="feature-list">
      <li>
        <b>Card Editing</b>
        Use the edit buttons on the Ability Scores and Character and Story cards to unlock those sections for updates. Toggle the
        button again to relock the cards and avoid accidental changes during play.
      </li>
      <li>
        <b>Encounter / Initiative</b>
        Add combatants with their initiative values, then step through turns with <i>Prev Turn</i> and <i>Next Turn</i>. Use <i>Reset</i>
        when a fight ends.
      </li>
      <li>
        <b>Action Log</b>
        Automated events such as damage, healing, rests, and resource adjustments appear here. Open the full log for a
        chronological history.
      </li>
      <li>
        <b>Campaign Log</b>
        Capture session highlights as short entries. Each note stays tied to the active character and saves automatically.
      </li>
      <li>
        <b>Rules Reference</b>
        The Rules modal provides quick summaries of key mechanics while keeping the character sheet visible behind it.
      </li>
    </ul>
    <h4>Frequently Asked Questions</h4>
    <ul class="feature-list">
      <li>
        <b>How often does the sheet save?</b>
        Autosave runs in the background while you edit. Use <i>Save</i> in the Load / Save modal any time you want to capture an
        explicit checkpoint.
      </li>
      <li>
        <b>How do I change the theme?</b>
        Tap the Catalyst Core logo. Each press advances to the next palette, and Story classifications with theme tie-ins can set
        their own look automatically.
      </li>
      <li>
        <b>Where do I track Resonance Points?</b>
        The Combat tab includes the Resonance Point track and Heroic Surge callouts so you can see current and aftermath states at
        a glance.
      </li>
      <li>
        <b>Can I work offline?</b>
        Yes. After the app loads once, it functions offline. Any edits you make sync the next time you reconnect.
      </li>
      <li>
        <b>How do I restore an earlier state?</b>
        Use <i>Recover Save</i> to browse timestamps for autosaves and manual backups, then confirm the one you need.
      </li>
      <li>
        <b>Where can I find gear options?</b>
        Open the Gear tab and tap the catalog button to browse equipment from the bundled data files or add custom entries.
      </li>
      <li>
        <b>How do I keep narrative notes?</b>
        Pair the Story tab’s questions and freeform notes with the Campaign Log’s timestamped entries for a complete journal of the
        character and the campaign.
      </li>
      <li>
        <b>How do I secure my character on a shared device?</b>
        Set a PIN in Load / Save. The sheet asks for that code before someone can open or edit the character.
      </li>
    </ul>
  </div>
</div>

<!-- INITIATIVE MODAL -->
<div class="overlay hidden" id="modal-enc" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Encounter Tracker</h3>
    <fieldset class="inline">
      <legend class="sr-only">Add Combatant</legend>
      <label for="enc-name" class="sr-only">Name</label>
      <input id="enc-name" data-view-allow placeholder="Name"/>
      <label for="enc-init" class="sr-only">Init</label>
      <input id="enc-init" data-view-allow type="number" inputmode="numeric" pattern="[0-9]*" placeholder="Init"/>
      <button id="enc-add" class="btn-sm">Add</button>
    </fieldset>
    <div class="encounter-readouts">
      <div class="encounter-readout">
        <span class="encounter-readout__label">Round</span>
        <span id="enc-round" class="encounter-readout__value">&mdash;</span>
      </div>
      <div class="encounter-readout">
        <span class="encounter-readout__label">Active</span>
        <span
          id="enc-active"
          class="encounter-readout__value"
          role="status"
          aria-live="polite"
          aria-atomic="true"
        >No active combatant</span>
      </div>
    </div>
    <div id="enc-list" class="catalog" style="margin-top:8px"></div>
    <div class="actions">
      <button id="enc-prev" class="btn-sm">Prev Turn</button>
      <button id="enc-next" class="btn-sm">Next Turn</button>
      <button id="enc-reset" class="btn-sm">Reset</button>
    </div>
  </div>
</div>

<div class="overlay hidden" id="modal-hp-settings" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>HP Options</h3>
    <div class="hp-settings__section">
      <label for="hp-temp">Temporary HP</label>
      <input id="hp-temp" data-view-allow type="number" inputmode="numeric" pattern="[0-9]*" placeholder="Temp HP"/>
    </div>
    <div class="hp-settings__section">
      <label for="hp-roll-input">Tier HP Bonus</label>
      <div class="hp-settings__row">
        <input id="hp-roll-input" data-view-allow type="number" inputmode="numeric" pattern="[0-9]*" placeholder="Tier HP Bonus"/>
        <button id="hp-roll-save" class="btn-sm" type="button">Add</button>
      </div>
      <ul id="hp-roll-list"></ul>
    </div>
    <div class="actions hp-settings__actions">
      <button id="hp-full" class="btn-sm">Reset HP</button>
      <button class="btn-sm" data-close>Close</button>
    </div>
  </div>
</div>


<div class="overlay hidden" id="modal-sp-settings" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>SP Options</h3>
    <div class="hp-settings__section">
      <label for="sp-temp">Temporary SP</label>
      <input id="sp-temp" data-view-allow type="number" inputmode="numeric" pattern="[0-9]*" placeholder="Temp SP"/>
    </div>
    <div class="actions hp-settings__actions">
      <button id="long-rest" class="btn-sm" type="button">Long Rest</button>
      <button id="sp-settings-save" class="btn-sm" type="button">Save</button>
      <button class="btn-sm" data-close>Close</button>
    </div>
  </div>
</div>

<!-- LOG MODAL -->
<div class="overlay hidden" id="modal-log" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Action Log</h3>
    <div id="log-action" class="catalog"></div>
    <div class="actions"><button id="log-full" class="btn-sm">Full Log</button><button class="btn-sm" data-close>Close</button></div>
  </div>
</div>


<div class="overlay hidden" id="modal-campaign" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Campaign Log</h3>
    <label for="campaign-entry" class="sr-only">Campaign Log Entry</label>
    <textarea id="campaign-entry" data-view-allow rows="2" placeholder="Session notes..."></textarea>
    <div class="actions">
      <button id="campaign-add" class="btn-sm" style="max-width:140px">Add Entry</button>
    </div>
    <div id="campaign-log" class="catalog"></div>
    <div class="actions actions--center"><button id="campaign-view-backlog" class="btn-sm" type="button" disabled aria-disabled="true">View Backlog</button></div>
    <div class="actions"><button class="btn-sm" data-close>Close</button></div>
  </div>
</div>

<div class="overlay hidden" id="modal-campaign-backlog" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Campaign Log Backlog</h3>
    <div id="campaign-backlog" class="catalog"></div>
    <div class="actions"><button class="btn-sm" data-close>Close</button></div>
  </div>
</div>

<div class="overlay hidden" id="modal-log-full" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Full Action Log</h3>
    <div id="full-log-action" class="catalog"></div>
    <div class="actions"><button class="btn-sm" data-close>Close</button></div>
  </div>
</div>

<div class="overlay hidden" id="modal-faction-perk" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-label="Faction Perk" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Faction Perk</h3>
    <ul id="modal-faction-perk-list" class="perk-list"></ul>
  </div>
</div>


<!-- GEAR CATALOG -->
<div class="overlay hidden" id="modal-catalog" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Gear Catalog</h3>
    <fieldset class="inline" style="margin:6px 0">
      <legend class="sr-only">Filters</legend>
      <label for="catalog-filter-style" class="sr-only">Style</label>
      <select id="catalog-filter-style" data-view-allow style="max-width:260px"></select>
      <label for="catalog-filter-type" class="sr-only">Type</label>
      <select id="catalog-filter-type" data-view-allow style="max-width:180px"><option value="">All Types</option><option>Armor</option><option>Shield</option><option>Utility</option></select>
      <label for="catalog-filter-rarity" class="sr-only">Rarity</label>
      <select id="catalog-filter-rarity" data-view-allow style="max-width:160px"><option value="">All Rarities</option><option>Common</option><option>Uncommon</option><option>Rare</option><option>Elite</option><option>Legendary</option></select>
      <button id="catalog-add-custom" class="btn-sm" type="button" data-view-allow>Add Custom Item</button>
    </fieldset>
    <div id="catalog-list" class="catalog"></div>
</div>
</div>

<div class="overlay hidden" id="modal-custom-item" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Create Custom Item</h3>
    <p>Select the type of custom item to add.</p>
    <div class="custom-type-grid">
      <button class="btn-sm" type="button" data-custom-type="weapon">Weapon</button>
      <button class="btn-sm" type="button" data-custom-type="armor">Armor</button>
      <button class="btn-sm" type="button" data-custom-type="shield">Shield</button>
      <button class="btn-sm" type="button" data-custom-type="utility">Utility</button>
      <button class="btn-sm" type="button" data-custom-type="item">Item</button>
    </div>
    <div class="actions">
      <button class="btn-sm" type="button" data-close>Cancel</button>
    </div>
  </div>
</div>

<div class="overlay hidden" id="modal-power-editor" aria-hidden="true" data-modal-static data-view-allow>
  <div class="modal modal-power-editor" role="dialog" aria-modal="true" aria-labelledby="power-editor-title" tabindex="-1" data-view-allow>
    <button class="x" type="button" data-power-editor-dismiss aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3 id="power-editor-title">Edit Power</h3>
    <div class="power-editor__content" data-role="power-editor-content" data-view-allow></div>
    <div class="actions power-editor__actions">
      <button class="btn-sm" type="button" data-power-editor-cancel>Cancel</button>
      <button class="btn-sm btn-primary" type="button" data-power-editor-save>Save</button>
    </div>
  </div>
</div>

<!-- RULES -->
<div class="overlay hidden" id="modal-rules" aria-hidden="true">
  <div class="modal modal-rules" role="dialog" aria-modal="true" aria-label="Rules Help" tabindex="-1">
    <button class="x" data-close aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <pre id="rules-text"></pre>
  </div>
</div>

<div id="somf-min-modal" class="somf-modal" hidden>
  <div class="somf-modal__backdrop" data-somf-dismiss></div>
  <div class="somf-modal__card somf-modal__card--image">
    <button id="somf-min-close" class="somf-modal__x" aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <img id="somf-min-image" class="somf-modal__art" alt="Shard artwork" loading="lazy">
    <div id="somf-min-details" class="somf-modal__details">
      <h3 id="somf-min-name" class="somf-modal__name"></h3>
      <p id="somf-min-visual" class="somf-modal__visual"></p>
      <ol id="somf-min-effects" class="somf-modal__effects"></ol>
    </div>
  </div>
</div>

<footer>
  <p>When the whole world tells you to move, it's your job to plant yourself like a tree by the river of truth and tell the whole world - no, YOU move.</p>
  <button id="dm-login" class="dm-login-btn" type="button" aria-label="DM Tools">
    <img class="dm-login-logo" src="images/XoVrom.png" alt="XoVrom Industries logo">
  </button>
  <div class="dm-tools-portal">
    <div id="dm-tools-menu" class="dm-tools-menu" hidden>
      <button id="dm-tools-tsomf" class="btn-sm">TSoMF</button>
      <button id="dm-tools-notifications" class="btn-sm">Notifications</button>
      <button id="dm-tools-characters" class="btn-sm">Characters</button>
      <button id="dm-tools-mini-games" class="btn-sm">Mini-Games</button>
      <button id="dm-tools-logout" class="btn-sm">Logout</button>
    </div>
    <button id="dm-tools-toggle" class="dm-tools-toggle" type="button" hidden aria-haspopup="true" aria-controls="dm-tools-menu" aria-expanded="false" aria-label="DM tools menu">
      <img class="dm-tools-toggle__icon" src="images/set-up-svgrepo-com.svg" alt="" aria-hidden="true" />
      <span class="sr-only">DM Tools</span>
    </button>
  </div>
</footer>
<div class="overlay hidden" id="dm-login-modal" aria-hidden="true">
  <section class="modal">
    <button id="dm-login-close" class="x" aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>DM Login</h3>
    <input id="dm-login-pin" data-view-allow type="password" inputmode="numeric" pattern="[0-9]*" autocomplete="one-time-code">
    <div class="actions"><button id="dm-login-submit" class="somf-btn">Enter</button></div>
  </section>
</div>
<div class="overlay hidden" id="dm-notifications-modal" aria-hidden="true">
  <section class="modal">
    <button id="dm-notifications-close" class="x" aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Notifications</h3>
    <ol id="dm-notifications-list"></ol>
  </section>
</div>
<div class="overlay hidden" id="dm-characters-modal" aria-hidden="true">
  <section class="modal dm-characters">
    <button id="dm-characters-close" class="x" aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>All Characters</h3>
    <ul id="dm-characters-list" class="dm-characters-list"></ul>
  </section>
</div>
<div class="overlay hidden" id="dm-character-modal" aria-hidden="true">
  <section class="modal dm-character">
    <button id="dm-character-close" class="x" aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <div id="dm-character-sheet" class="dm-character-sheet" title="Character Sheet"></div>
  </section>
</div>
<div class="overlay hidden" id="dm-mini-games-modal" aria-hidden="true">
  <section class="modal dm-mini-games" data-view-allow>
    <button id="dm-mini-games-close" class="x" aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <h3>Deploy Mini-Games</h3>
    <p id="dm-mini-games-steps" class="dm-mini-games__intro">Step 1: Choose a mini-game from the library to get started.</p>
    <div class="dm-mini-games__layout">
      <aside class="dm-mini-games__sidebar">
        <h4 class="dm-mini-games__section-title">Mini-Game Library</h4>
        <ul id="dm-mini-games-list" class="dm-mini-games__list" role="listbox" aria-label="Mini-game library"></ul>
      </aside>
      <div class="dm-mini-games__content">
        <header class="dm-mini-games__header">
          <div class="dm-mini-games__heading">
            <h4 id="dm-mini-games-title" class="dm-mini-games__title">Select a mini-game</h4>
            <p id="dm-mini-games-tagline" class="dm-mini-games__tagline"></p>
          </div>
          <a id="dm-mini-games-launch" class="dm-mini-games__launch" href="#" target="_blank" rel="noopener" hidden>Open Player View</a>
        </header>
        <section class="dm-mini-games__section">
          <h5 class="dm-mini-games__section-heading">Step 2 · Tune the Mission (DM only)</h5>
          <p id="dm-mini-games-knobs-hint" class="dm-mini-games__hint">Choose a mini-game to unlock DM-only tuning controls. Safe ranges and defaults are highlighted for every knob.</p>
          <div id="dm-mini-games-knobs" class="dm-mini-games__knobs"></div>
        </section>
        <section class="dm-mini-games__section">
          <h5 class="dm-mini-games__section-heading">Step 3 · Send to a Player</h5>
          <p id="dm-mini-games-player-hint" class="dm-mini-games__hint">Pick who should receive the mission and add any quick instructions.</p>
          <div class="dm-mini-games__deploy-form">
            <label class="dm-mini-games__field">
              <span>Select character</span>
              <select id="dm-mini-games-player">
                <option value="">Loading…</option>
              </select>
            </label>
            <label class="dm-mini-games__field">
              <span>Or enter name</span>
              <input id="dm-mini-games-player-custom" type="text" placeholder="Custom target name"/>
            </label>
            <label class="dm-mini-games__field">
              <span>DM notes (optional)</span>
              <textarea id="dm-mini-games-notes" rows="2" placeholder="Add private context for the player"></textarea>
            </label>
            <div class="dm-mini-games__actions">
              <button id="dm-mini-games-refresh-players" type="button" class="btn-sm">Refresh Characters</button>
              <button id="dm-mini-games-deploy" type="button" class="somf-btn somf-primary">Deploy Mini-Game</button>
            </div>
          </div>
        </section>
        <section class="dm-mini-games__section dm-mini-games__section--scroll">
          <h5 class="dm-mini-games__section-heading">Mission Briefing (Player View)</h5>
          <pre id="dm-mini-games-readme" class="dm-mini-games__readme" tabindex="0">Select a mini-game to view its briefing.</pre>
        </section>
        <section class="dm-mini-games__section dm-mini-games__section--scroll">
          <div class="dm-mini-games__section-header">
            <h5 class="dm-mini-games__section-heading">Active Deployments</h5>
            <div class="dm-mini-games__section-actions">
              <button id="dm-mini-games-refresh" type="button" class="btn-sm">Refresh</button>
            </div>
          </div>
          <ul id="dm-mini-games-deployments" class="dm-mini-games__deployments"></ul>
        </section>
      </div>
    </div>
  </section>
</div>

<div class="overlay hidden" id="mini-game-invite" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="mini-game-invite-title" data-modal-static>
  <section class="modal mini-game-invite">
    <header class="mini-game-invite__header">
      <h3 id="mini-game-invite-title" class="mini-game-invite__title">Incoming Mini-Game Assignment</h3>
      <p id="mini-game-invite-message" class="mini-game-invite__message"></p>
    </header>
    <div class="mini-game-invite__game">
      <div id="mini-game-invite-game" class="mini-game-invite__name"></div>
      <p id="mini-game-invite-tagline" class="mini-game-invite__tagline"></p>
    </div>
    <div id="mini-game-invite-summary" class="mini-game-invite__summary"></div>
    <div id="mini-game-invite-notes" class="mini-game-invite__notes" hidden>
      <h4 class="mini-game-invite__notes-title">Briefing</h4>
      <p id="mini-game-invite-notes-text" class="mini-game-invite__notes-text"></p>
    </div>
    <footer class="mini-game-invite__actions">
      <button id="mini-game-invite-decline" type="button" class="btn-sm mini-game-invite__decline">Not Now</button>
      <button id="mini-game-invite-accept" type="button" class="somf-btn somf-primary mini-game-invite__accept">Start Mission</button>
    </footer>
  </section>
  </div>
  <div class="overlay hidden" id="modal-somf-dm" aria-hidden="true">
  <section id="somf-dm" class="modal somf-dm">
    <button id="somfDM-close" class="x" aria-label="Close">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"/>
      </svg>
    </button>
    <header class="somf-dm__hdr">
      <h3>DM • Shards <span id="somfDM-cardCount"></span></h3>
      <div class="somf-dm__hdr-controls">
        <div class="somf-dm__toggles">
          <label class="somf-switch"><span id="somfDM-playerCard-state">Off</span><input id="somfDM-playerCard" type="checkbox"><span>Reveal Shards</span></label>
        </div>
        <div class="somf-dm__actions">
          <button id="somfDM-reset" class="somf-btn">Reset</button>
        </div>
      </div>
    </header>

    <nav class="somf-dm__tabs">
      <button data-tab="cards" class="somf-dm-tabbtn active">Shards List</button>
      <button data-tab="resolve" class="somf-dm-tabbtn">Resolve</button>
      <button data-tab="npcs" class="somf-dm-tabbtn">NPCs</button>
      <button data-tab="items" class="somf-dm-tabbtn">Items</button>
    </nav>

    <section id="somfDM-tab-cards" class="somf-dm-tab somf-dm__tab active"></section>

    <section id="somfDM-tab-resolve" class="somf-dm-tab somf-dm__tab">
      <div class="somf-dm__resolve">
        <aside class="somf-dm__left">
          <h4>Incoming Draws</h4>
          <ol id="somfDM-incoming" class="somf-dm__list"></ol>
        </aside>
        <main class="somf-dm__main">
          <div id="somfDM-noticeView" class="somf-dm__card"></div>
          <div class="somf-dm__actions">
            <button id="somfDM-markResolved" class="somf-btn somf-primary" disabled>Mark Resolved</button>
            <button id="somfDM-spawnNPC" class="somf-btn" disabled>Spawn Related NPC</button>
          </div>
        </main>
      </div>
      <h4>Resolution Methods</h4>
      <ol id="somfDM-resolveOptions" class="somf-dm__list"></ol>
    </section>

    <section id="somfDM-tab-npcs" class="somf-dm-tab somf-dm__tab">
      <ul id="somfDM-npcList" class="somf-dm__list"></ul>
    </section>

    <section id="somfDM-tab-items" class="somf-dm-tab somf-dm__tab">
      <ul id="somfDM-itemList" class="somf-dm__list"></ul>
    </section>
  </section>
</div>

<div class="overlay hidden" id="somfDM-npcModal" aria-hidden="true">
  <section id="somfDM-npcModalCard" class="modal somf-dm"></section>
</div>

<!-- Toasts + Tiny Ping -->
<ul id="somfDM-notifications" class="somf-dm__queue"></ul>
<div id="somfDM-toasts" class="somf-dm__toasts"></div>
<audio id="somfDM-ping" preload="auto"></audio>

<div id="down-animation" aria-hidden="true" hidden></div>
<div id="death-animation" aria-hidden="true" hidden>
  <img src="images/death-animation.svg" alt="" decoding="async" loading="lazy" />
</div>
<div id="damage-animation" aria-hidden="true" hidden></div>
<div id="heal-animation" aria-hidden="true" hidden></div>
<div id="save-animation" aria-hidden="true" hidden></div>
<div id="coin-animation" aria-hidden="true" hidden></div>
<div id="sp-animation" aria-hidden="true" hidden></div>
<div id="load-animation" aria-hidden="true" hidden></div>
<div id="draw-lightning" aria-hidden="true" hidden></div>
<div id="draw-flash" aria-hidden="true" hidden></div>
<div class="overlay hidden" id="somf-confirm-draw" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="somf-confirm-title" aria-describedby="somf-confirm-description somf-confirm-count somf-confirm-consequence-label">
  <section class="modal somf-confirm" tabindex="-1">
    <header class="somf-confirm__header">
      <h3 id="somf-confirm-title" class="somf-confirm__title">Tempt Fate?</h3>
      <p id="somf-confirm-description" class="somf-confirm__description">Drawing from the Shards of Many Fates invites unpredictable magic.</p>
    </header>
    <p id="somf-confirm-count" class="somf-confirm__count">You are about to draw 1 Shard.</p>
    <p id="somf-confirm-consequence-label" class="somf-confirm__label">If you proceed, remember:</p>
    <ul id="somf-confirm-consequences" class="somf-confirm__list">
      <li>The Fates are fickle—outcomes may bless or curse.</li>
      <li>Draws are permanent and cannot be undone.</li>
    </ul>
    <footer class="somf-confirm__actions">
      <button type="button" class="btn-sm somf-confirm__cancel" data-somf-confirm-cancel>Not Now</button>
      <button type="button" class="somf-btn somf-primary somf-confirm__accept" data-somf-confirm-accept>Draw 1 Shard</button>
    </footer>
  </section>
</div>
<div id="somf-reveal-alert" class="somf-reveal-alert" hidden role="alertdialog" aria-modal="true" aria-labelledby="somf-reveal-title" aria-describedby="somf-reveal-text" aria-hidden="true">
  <div class="somf-reveal-alert__card" tabindex="-1">
    <h3 id="somf-reveal-title" class="somf-reveal-alert__title">The Shards of Many Fates</h3>
    <p id="somf-reveal-text" class="somf-reveal-alert__text">The Shards of Many Fates have revealed themselves to you, do you dare tempt Fate?</p>
    <button type="button" class="somf-reveal-alert__btn" data-somf-reveal-dismiss>Eeehhhhh…</button>
  </div>
</div>
<div id="app-alert" class="app-alert" hidden role="alertdialog" aria-modal="true" aria-labelledby="app-alert-title" aria-describedby="app-alert-message" aria-hidden="true">
  <div class="app-alert__card" tabindex="-1">
    <h3 id="app-alert-title" class="app-alert__title">O.M.N.I: Priority Transmission</h3>
    <p id="app-alert-message" class="app-alert__message" data-app-alert-message></p>
    <button type="button" class="app-alert__button" data-app-alert-dismiss>ACKNOWLEDGE</button>
  </div>
</div>
<div class="toast" id="toast" role="status" aria-live="polite"></div>
</div>
<script type="module" src="scripts/header-title.js"></script>
<script type="module" src="scripts/animated-titles.js"></script>
<script type="module" src="scripts/animated-title-spacing.js"></script>
<script type="module" src="scripts/main.js"></script>
<script type="module" src="scripts/dm.js"></script>
<script type="module" src="scripts/somf-firebase.js"></script>
<script src="shard-of-many-fates.js"></script>

</body>
</html>
